https:// {
    tls /certs/server.crt /certs/server.key

    # WebSocket proxy
    handle /ws {
        reverse_proxy {$GPU_HOST}:{$GPU_PORT}
    }

    # Health check
    handle /healthz {
        respond "OK" 200
    }

    # Static files
    handle {
        root * /srv
        file_server browse

        # Prevent browser caching of index.html (for development)
        header /index.html Cache-Control "no-cache, no-store, must-revalidate"
        header /index.html Pragma "no-cache"
        header /index.html Expires "0"
    }

    log {
        output stdout
    }
}

# HTTP on port 80
http:// {
    redir https://{host}{uri} permanent
}
